# Configuration de Centreon
## ğŸ§© Bonnes pratiques de configuration

### Commandes

- Nommage structurÃ© : `CHECK_SNMP_CPU`, `CHECK_NRPE_DISK`, etc.
- Toujours utiliser **des arguments variables** avec macros ($ARGn$, $_HOSTâ€¦$)
- Tester chaque commande en **ligne de commande avec centreon-engine** avant de lâ€™ajouter dans lâ€™interface

### Exemple SNMP CPU

```bash
/usr/lib/centreon/plugins/centreon_windows_snmp.pl \
--plugin=os::windows::snmp::plugin \
--mode=cpu \
--hostname=$HOSTADDRESS$ \
--snmp-community=$_HOSTSNMPCOMMUNITY$ \
--snmp-version=$_HOSTSNMPVERSION$ \
--warning-average=$ARG1$ --critical-average=$ARG2$
```

---

## ğŸ”„ Les macros

### Types de macros

|Type|Exemple|UtilitÃ©|
|---|---|---|
|Standard|`$HOSTADDRESS$`|Adresse IP de lâ€™hÃ´te|
|Ressource|`$USER1$`, `$CENTREONPLUGINS$`|Chemins systÃ¨mes communs|
|Argument|`$ARG1$`, `$ARG2$`|ParamÃ¨tres personnalisables par service|
|PersonnalisÃ©e|`$_HOSTVERSION$`, `$_SERVICEWARNING$`|Macros nommÃ©es, plus lisibles|
|Ã€ la demande|`$HOSTSTATE:serveurweb1$`|Statut dâ€™un autre hÃ´te/service|

### Avantages des macros personnalisÃ©es

- Plus claires et explicites
- Modifiables hÃ´te par hÃ´te ou service par service
- Pas limitÃ©es en nombre contrairement Ã  `$ARGn$`

---

## ğŸ› ï¸ Commandes (Checks)

### CrÃ©ation

Menu : **Configuration > Commands > Checks**

Champs Ã  renseigner :

- Nom (ex: `CHECK_SNMP_CPU`)
- Ligne de commande avec variables ($ARGn$, $_HOSTâ€¦$)
- Type de commande : `Check` ou `Misc`
- Plugin utilisÃ© : chemin via macro `$CENTREONPLUGINS$`, `$USER1$`

---

## ğŸ§± ModÃ¨les de services

### Objectif

- CrÃ©er une base rÃ©utilisable de services (CPU, RAM, HTTPâ€¦)
- Permet de centraliser les paramÃ¨tres standards et de les appliquer Ã  plusieurs hÃ´tes

### Types

|Type|Description|
|---|---|
|Configuration (STC_)|Contient les paramÃ¨tres communs (intervalle, pÃ©riodicitÃ©, seuilsâ€¦)|
|Fonctionnel (STF_)|Contient la commande (Check), les macros personnalisÃ©esâ€¦|

### Exemple

- STC_DEFAULT : intervalle 5 min, 3 tentatives, notifications activÃ©es
- STF_SNMP_CPU_WINDOWS : hÃ©ritage de STC_DEFAULT + check CPU avec SNMP

---

## ğŸ§± ModÃ¨les dâ€™hÃ´tes

### Objectif

- Appliquer des services Ã  un groupe de machines automatiquement
- Faciliter la maintenance

### Types

|Type|Description|Exemple|
|---|---|---|
|Configuration (HTC_)|ParamÃ¨tres SNMP, intervalle, notifications|HTC_DEFAULT|
|Fonctionnel (HTF_)|Regroupement par rÃ´le / type / OS|HTF_WIN_SRVWEB|

### Exemple

- HTC_DEFAULT : SNMP v2c, communautÃ© "sniper", vÃ©rification toutes les 5 min
- HTF_LINUX_SERVEUR : service de ping, charge CPU, espace disque

---

## ğŸ” GÃ©nÃ©ration de la configuration

### Centreon Web modifie la **base de donnÃ©es**

Les fichiers `.cfg` de Centreon-Engine ne sont gÃ©nÃ©rÃ©s quâ€™aprÃ¨s action manuelle :

1. **Configuration > Pollers > Generate Configuration** (mode debug recommandÃ©)
2. VÃ©rification de la gÃ©nÃ©ration
3. **DÃ©ploiement** : remplacement fichiers + redÃ©marrage moteur

---

## ğŸ‘ï¸ Interface de supervision

Menu : **Monitoring > Status Details**

- Vue en temps rÃ©el des **hÃ´tes** et **services** supervisÃ©s
- Statuts (OK, Warning, Critical, Unknown)
- PossibilitÃ© dâ€™effectuer des **actions groupÃ©es** (DÃ©sactiver, Planifier downtimeâ€¦)
- Vue dÃ©taillÃ©e dâ€™un hÃ´te ou service : journal, commandes, replanification de check

---

## ğŸ“Š Groupes et catÃ©gories

### Groupes

- UtilisÃ©s pour regrouper les hÃ´tes ou services (Windows, Linux, site, rÃ´leâ€¦)
- AffectÃ©s manuellement (pas dâ€™hÃ©ritage via template)

### CatÃ©gories

- Servent Ã  regrouper objets par **droit dâ€™accÃ¨s ou vue mÃ©tier**
- UtilisÃ©es dans les modules payants pour crÃ©er des vues dynamiques
- HÃ©ritage possible via modÃ¨le dâ€™hÃ´te ou service

---

## âœ… Ã€ retenir pour les rÃ©visions

- Lâ€™Ã©criture dâ€™une commande doit Ãªtre **testÃ©e manuellement** et inclure des **macros variables**
- Les **modÃ¨les** permettent un dÃ©ploiement rapide, homogÃ¨ne et maintenable
- Les fichiers `.cfg` ne sont pas gÃ©nÃ©rÃ©s en temps rÃ©el â†’ penser Ã  **gÃ©nÃ©rer et dÃ©ployer**
- Les macros personnalisÃ©es permettent des configurations plus explicites et flexibles

---

## ğŸ“Œ Bonnes pratiques professionnelles

- Respecter une **convention de nommage stricte** pour tous les objets (CHECK_, STC_, STF_, HTC_, HTF_)
- **Centraliser les chemins plugins** dans des macros ressources
- CrÃ©er un **template STC par dÃ©faut** pour homogÃ©nÃ©iser les services
- GÃ©nÃ©rer et tester la config **en mode debug** avant application
- Documenter chaque **commande**, modÃ¨le et macro personnalisÃ©e