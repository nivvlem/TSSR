# Supervision distribuÃ©e avec Centreon
## ğŸ§© Principes de la supervision distribuÃ©e

- Architecture recommandÃ©e pour :
    - **Gros environnements** (plusieurs centaines dâ€™hÃ´tes)
    - **Sites distants** avec bande passante limitÃ©e
- Composants :
    - **Centreon Central** : interface web, base de donnÃ©es, moteur central (Engine), Broker principal
    - **Centreon Poller(s)** : serveur distant avec moteur de supervision (Engine) + Broker (module uniquement)
- Communication entre Central et Pollers :
    - Utilise **SSH** ou **ZMQ** (ZeroMQ)
    - NÃ©cessite **Ã©change de clÃ©s SSH** entre Central et Pollers

---

## ğŸ”„ RÃ´le des serveurs dans une architecture distribuÃ©e

### Serveur Central

- Contient :
    - **Centreon Web** (interface)
    - **Centreon Broker Database** (vers base MariaDB ou PostgreSQL)
    - **Base de donnÃ©es RRD** (graphes)
    - Service **Gorgone** : transfert de config vers les pollers

### Serveurs Pollers (Satellites)

- Composants installÃ©s :
    - **Centreon Engine** : moteur de supervision
    - **Centreon Broker Module** : collecte les rÃ©sultats des checks
- Fonctionnent **de maniÃ¨re autonome** :
    - Stockent les donnÃ©es temporairement si le Central est indisponible
    - Les synchronisent ensuite Ã  la reconnexion

---

## ğŸ› ï¸ Configuration dâ€™un poller dans Centreon

1. Depuis **Centreon Web > Configuration > Pollers**
2. Ajouter un nouveau poller :
    - Nom explicite (ex : `Poller_Nagoya`)
    - IP interne accessible depuis Central
    - DÃ©finir les options SSH ou ZMQ
3. Attribuer les hÃ´tes au bon poller via leur fiche ou modÃ¨le dâ€™hÃ´te
4. **GÃ©nÃ©rer la configuration** depuis lâ€™interface (comme pour Central)
5. Centreon **Gorgone** se charge de dÃ©ployer les fichiers sur le poller distant

---

## ğŸ§¬ RÃ©silience et indÃ©pendance des pollers

- Chaque poller peut continuer Ã  :
    - Lancer ses propres checks (Engine local)
    - Stocker les rÃ©sultats (en cache)
    - Reprendre la synchronisation dÃ¨s que la liaison avec le Central est rÃ©tablie
- Le poller nâ€™a pas besoin dâ€™interface web ni de base SQL complÃ¨te
- En cas de **perte rÃ©seau**, pas de perte de supervision locale

---

## ğŸ“œ Historique technique : de NDOUtils Ã  Centreon Broker

|Composant|Fonction|RemplacÃ© par|
|---|---|---|
|Nagios|Moteur de supervision|Centreon Engine|
|NDOUtils|Ã‰criture base SQL|Centreon Broker|
|NDOMOD|Plugin Nagios â†’ NDO|centreon-broker-module|
|NDO2DB|RÃ©cepteur TCP pour SQL|centreon-broker-database|

---

## âœ… Ã€ retenir pour les rÃ©visions

- La supervision distribuÃ©e repose sur des **pollers autonomes** dÃ©ployÃ©s sur des sites distants ou pour rÃ©partir la charge
- Le **Central pilote lâ€™ensemble** via lâ€™interface et Gorgone
- **Centreon Broker** est le cÅ“ur de la transmission : module local â†’ base centrale
- En cas de coupure, les **pollers tamponnent les donnÃ©es** et les synchronisent ensuite

---

## ğŸ“Œ Bonnes pratiques professionnelles

- Bien **nommer les pollers** et leur associer un sous-rÃ©seau ou un site
- **Tester la clÃ© SSH** entre Central et chaque poller (`ssh poller_user@poller_ip`)
- Documenter les **affectations dâ€™hÃ´tes par poller**
- VÃ©rifier la bonne rÃ©ception des donnÃ©es par le Broker via les logs
- Anticiper les **plans de reprise** en cas de perte du Central